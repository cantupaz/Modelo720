FROM python:3.12-slim

WORKDIR /workspace

# Copy requirements and install
COPY requirements.txt /workspace/
RUN pip install --no-cache-dir -r /workspace/requirements.txt

# Install dev dependencies
RUN pip install --no-cache-dir pytest pytest-cov

# Copy the library code
COPY Modelo720/ /workspace/Modelo720/
COPY main.py test_modelo720.py /workspace/
COPY example.720 example.csv example-rewritten.720 /workspace/

# Install library in editable mode
COPY pyproject.toml MANIFEST.in /workspace/
RUN pip install -e /workspace

WORKDIR /workspace

# Set the default shell to bash instead of sh
ENV SHELL /bin/bash

# Default command runs tests
CMD ["pytest"]
